<!DOCTYPE html>
<html>
<head>
    <title>Ferghana Guide</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=<!DOCTYPE html>
<html>
<head>
    <title>Ferghana Guide</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCHvZ8CU85WWc1k5jBxlxQ7qWh2GQP2MnU"></script>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f0f0f0; }
        button { padding: 10px; margin: 5px; background: #007bff; color: white; border: none; cursor: pointer; }
        .place { background: white; padding: 10px; margin: 10px 0; border-radius: 5px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        img { max-width: 100%; height: auto; }
        a { color: #007bff; text-decoration: none; }
        form { margin-top: 20px; }
        textarea { width: 100%; margin-bottom: 10px; }
        #map { height: 300px; width: 100%; margin-top: 10px; }
    </style>
</head>
<body>
    <h1>Фергана Гид</h1>
    <button onclick="showCategory('food')">Еда</button>
    <button onclick="showCategory('family')">Семейный отдых</button>
    <button onclick="showCategory('evening')">Вечер</button>
    <button onclick="showCategory('deals')">Акции и скидки</button>
    <div id="places"></div>

    <form id="feedbackForm" onsubmit="submitFeedback(event)">
        <h2>Оставить отзыв</h2>
        <textarea id="feedbackText" placeholder="Напишите ваш отзыв..." rows="4" cols="50"></textarea>
        <br>
        <button type="submit">Отправить</button>
    </form>

    <script>
        const places = [
            { category: "food", name: "Вкусный Плов", desc: "Лучший плов", img: "https://твой_сайт.com/фото_плова.jpg", map: { lat: 40.384, lng: 71.784 } },
            { category: "family", name: "Парк Алишер Навои", desc: "Для детей", img: "https://твой_сайт.com/фото_парка.jpg", map: { lat: 40.380, lng: 71.785 } },
            { category: "deals", name: "Скидка 20% в Кафе Уют", desc: "Акция до 15 марта 2025", img: "https://твой_сайт.com/акция_кафе.jpg", map: { lat: 40.385, lng: 71.783 } }
        ];

        let map;

        function initMap() {
            map = new google.maps.Map(document.getElementById("map"), {
                center: { lat: 40.384, lng: 71.784 }, // Центр Ферганы
                zoom: 14,
            });
        }

        function showCategory(category) {
            const filtered = places.filter(p => p.category === category);
            const div = document.getElementById("places");
            div.innerHTML = "";
            filtered.forEach(place => {
                div.innerHTML += `
                    <div class="place">
                        <h2>${place.name}</h2>
                        <p>${place.desc}</p>
                        <img src="${place.img}">
                        <button onclick="showMap(${place.map.lat}, ${place.map.lng})">Показать на карте</button>
                    </div>`;
            });
        }

        function showMap(lat, lng) {
            if (!map) initMap();
            map.setCenter({ lat: lat, lng: lng });
            new google.maps.Marker({
                position: { lat: lat, lng: lng },
                map: map,
                title: "Место в Фергане"
            });
            document.getElementById("places").innerHTML += '<div id="map"></div>';
        }

        function submitFeedback(event) {
            event.preventDefault();
            const feedback = document.getElementById("feedbackText").value;
            if (feedback.trim()) {
                fetch(`https://api.telegram.org/bot${window.Telegram.WebApp.initDataUnsafe.user.id}/sendMessage`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        chat_id: 849124681, // Замени на твой ID в Telegram
                        text: `Новый отзыв из Mini App: ${feedback}`
                    })
                });
                alert("Спасибо за ваш отзыв!");
                document.getElementById("feedbackText").value = "";
            } else {
                alert("Пожалуйста, введите отзыв.");
            }
        }

        // Подключение к Telegram
        window.Telegram.WebApp.ready();
        window.Telegram.WebApp.expand();
        initMap(); // Инициализация карты при загрузке
    </script>
</body>
</html>"></script>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f0f0f0; }
        button { padding: 10px; margin: 5px; background: #007bff; color: white; border: none; cursor: pointer; }
        .place { background: white; padding: 10px; margin: 10px 0; border-radius: 5px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        img { max-width: 100%; height: auto; }
        a { color: #007bff; text-decoration: none; }
        form { margin-top: 20px; }
        textarea { width: 100%; margin-bottom: 10px; }
        #map { height: 300px; width: 100%; margin-top: 10px; }
    </style>
</head>
<body>
    <h1>Фергана Гид</h1>
    <button onclick="showCategory('food')">Еда</button>
    <button onclick="showCategory('family')">Семейный отдых</button>
    <button onclick="showCategory('evening')">Вечер</button>
    <button onclick="showCategory('deals')">Акции и скидки</button>
    <div id="places"></div>

    <form id="feedbackForm" onsubmit="submitFeedback(event)">
        <h2>Оставить отзыв</h2>
        <textarea id="feedbackText" placeholder="Напишите ваш отзыв..." rows="4" cols="50"></textarea>
        <br>
        <button type="submit">Отправить</button>
    </form>

    <script>
        const places = [
            { category: "food", name: "Вкусный Плов", desc: "Лучший плов", img: "https://твой_сайт.com/фото_плова.jpg", map: { lat: 40.384, lng: 71.784 } },
            { category: "family", name: "Парк Алишер Навои", desc: "Для детей", img: "https://твой_сайт.com/фото_парка.jpg", map: { lat: 40.380, lng: 71.785 } },
            { category: "deals", name: "Скидка 20% в Кафе Уют", desc: "Акция до 15 марта 2025", img: "https://твой_сайт.com/акция_кафе.jpg", map: { lat: 40.385, lng: 71.783 } }
        ];

        let map;

        function initMap() {
            map = new google.maps.Map(document.getElementById("map"), {
                center: { lat: 40.384, lng: 71.784 }, // Центр Ферганы
                zoom: 14,
            });
        }

        function showCategory(category) {
            const filtered = places.filter(p => p.category === category);
            const div = document.getElementById("places");
            div.innerHTML = "";
            filtered.forEach(place => {
                div.innerHTML += `
                    <div class="place">
                        <h2>${place.name}</h2>
                        <p>${place.desc}</p>
                        <img src="${place.img}">
                        <button onclick="showMap(${place.map.lat}, ${place.map.lng})">Показать на карте</button>
                    </div>`;
            });
        }

        function showMap(lat, lng) {
            if (!map) initMap();
            map.setCenter({ lat: lat, lng: lng });
            new google.maps.Marker({
                position: { lat: lat, lng: lng },
                map: map,
                title: "Место в Фергане"
            });
            document.getElementById("places").innerHTML += '<div id="map"></div>';
        }

        function submitFeedback(event) {
            event.preventDefault();
            const feedback = document.getElementById("feedbackText").value;
            if (feedback.trim()) {
                fetch(`https://api.telegram.org/bot${window.Telegram.WebApp.initDataUnsafe.user.id}/sendMessage`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        chat_id: YOUR_CHAT_ID, // Замени на твой ID в Telegram
                        text: `Новый отзыв из Mini App: ${feedback}`
                    })
                });
                alert("Спасибо за ваш отзыв!");
                document.getElementById("feedbackText").value = "";
            } else {
                alert("Пожалуйста, введите отзыв.");
            }
        }

        // Подключение к Telegram
        window.Telegram.WebApp.ready();
        window.Telegram.WebApp.expand();
        initMap(); // Инициализация карты при загрузке
    </script>
</body>
</html>